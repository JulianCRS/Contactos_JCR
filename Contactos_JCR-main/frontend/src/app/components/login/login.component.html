<div class="auth-container">
  <div class="auth-card">
    <div class="auth-tabs">
      <button [class.active]="!isSignup" (click)="toggleMode(false)">Iniciar SesiÃ³n</button>
      <button [class.active]="isSignup" (click)="toggleMode(true)">Registrarse</button>
    </div>

    <form [formGroup]="authForm" (ngSubmit)="onSubmit()">
      <div class="form-instructions" *ngIf="isSignup">
        <p>Para registrarte necesitas:</p>
        <ul>
          <li [class.completed]="authForm.get('username')?.valid">Nombre de usuario</li>
          <li [class.completed]="authForm.get('email')?.valid">Email vÃ¡lido</li>
          <li [class.completed]="authForm.get('password')?.valid">ContraseÃ±a (mÃ­nimo 6 caracteres)</li>
          <li [class.completed]="!authForm.errors?.['mismatch'] && authForm.get('confirmPassword')?.valid">Confirmar contraseÃ±a</li>
        </ul>
      </div>

      <div class="form-field" *ngIf="isSignup">
        <label>Usuario: <span class="required">*</span></label>
        <input
          formControlName="username"
          type="text"
          placeholder="Ingresa tu usuario"
          [class.invalid]="authForm.get('username')?.invalid && authForm.get('username')?.touched">
        <div class="field-hint">El nombre que otros usuarios verÃ¡n</div>
        <div *ngIf="authForm.get('username')?.errors?.['required'] && authForm.get('username')?.touched" class="error-message">
          El usuario es requerido
        </div>
      </div>

      <div class="form-field">
        <label>Email: <span class="required">*</span></label>
        <input
          formControlName="email"
          type="email"
          placeholder="ejemplo@correo.com"
          [class.invalid]="authForm.get('email')?.invalid && authForm.get('email')?.touched">
        <div class="field-hint">UsarÃ¡s este email para iniciar sesiÃ³n</div>
        <div *ngIf="authForm.get('email')?.errors?.['required'] && authForm.get('email')?.touched" class="error-message">
          El email es requerido
        </div>
        <div *ngIf="authForm.get('email')?.errors?.['email'] && authForm.get('email')?.touched" class="error-message">
          Por favor, ingresa un email vÃ¡lido
        </div>
      </div>

      <div class="form-field password-field">
        <label>ContraseÃ±a: <span class="required">*</span></label>
        <div class="password-input-container">
          <input
            formControlName="password"
            [type]="showPassword ? 'text' : 'password'"
            placeholder="MÃ­nimo 6 caracteres"
            [class.invalid]="authForm.get('password')?.invalid && authForm.get('password')?.touched">
          <button type="button"
                  class="toggle-password"
                  (click)="togglePasswordVisibility('password')"
                  [attr.aria-label]="showPassword ? 'Ocultar contraseÃ±a' : 'Mostrar contraseÃ±a'">
            {{ showPassword ? 'ğŸ”“' : 'ğŸ”’' }}
          </button>
        </div>
        <div class="field-hint">MÃ­nimo 6 caracteres</div>
        <div *ngIf="authForm.get('password')?.errors?.['required'] && authForm.get('password')?.touched" class="error-message">
          La contraseÃ±a es requerida
        </div>
        <div *ngIf="authForm.get('password')?.errors?.['minlength'] && authForm.get('password')?.touched" class="error-message">
          La contraseÃ±a debe tener al menos 6 caracteres
        </div>
      </div>

      <div class="form-field password-field" *ngIf="isSignup">
        <label>Confirmar ContraseÃ±a: <span class="required">*</span></label>
        <div class="password-input-container">
          <input
            formControlName="confirmPassword"
            [type]="showConfirmPassword ? 'text' : 'password'"
            placeholder="Repite tu contraseÃ±a"
            [class.invalid]="(authForm.errors?.['mismatch'] || authForm.get('confirmPassword')?.errors?.['required']) && authForm.get('confirmPassword')?.touched">
          <button type="button"
                  class="toggle-password"
                  (click)="togglePasswordVisibility('confirmPassword')"
                  [attr.aria-label]="showConfirmPassword ? 'Ocultar contraseÃ±a' : 'Mostrar contraseÃ±a'">
            {{ showConfirmPassword ? 'ğŸ”“' : 'ğŸ”’' }}
          </button>
        </div>
        <div class="field-hint">Debe coincidir con la contraseÃ±a anterior</div>
        <div *ngIf="authForm.errors?.['mismatch'] && authForm.get('confirmPassword')?.touched" class="error-message">
          Las contraseÃ±as no coinciden
        </div>
      </div>

      <button type="submit" [disabled]="authForm.invalid || loading">
        {{ isSignup ? 'Registrarse' : 'Iniciar SesiÃ³n' }}
      </button>

      <div class="validation-message" *ngIf="authForm.invalid">
        Complete todos los campos requeridos
      </div>

      <div *ngIf="error" class="error-alert">
        <i class="error-icon">âš ï¸</i>
        {{ error }}
      </div>

      <div *ngIf="successMessage" class="success-alert">
        <i class="success-icon">âœ“</i>
        {{ successMessage }}
      </div>
    </form>
  </div>
</div>
